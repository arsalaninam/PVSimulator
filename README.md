# PV Simulator

This is a python based Producer (Meter) and Consumer (PV Simulator) application that uses RabbitMQ as a messaging broker. 

Meter application produces the random data ranged between 0 and 9000 in Watts, and publishes to the broker.

PV Simulator application listens to the broker, generates its own PV power value and writes the data in a file called Output.txt.

## Technology Stack

- Python
- RabbitMQ
- Docker

## Pre requisite

In order to execute the application, please install Docker Desktop on your host machine.
You can easily download it from https://www.docker.com/products/docker-desktop/

Once it is downloaded and installed, kindly run Docker server on your host machine. You need to make sure Docker desktop
is running on background.

## Choose your favorite IDE

Open it on your favorite IDE, some famous IDEs for Python based applications are Visual Code studio and PyCharm. You can download it from the following URLs respectively.

https://code.visualstudio.com/download

https://www.jetbrains.com/pycharm/download/

## Code Structure
>Directory (meter)

>>Meter.py: It contains the Producer application code which is acting as Meter

>>Dockerfile: It contains the docker configuration to build a docker image for Meter application

>Directory (pvsimulator)

>>PVSimulator.py: It contains the Consumer application code with Python

>>Dockerfile: It contains the docker configuration to build a docker image for PVSimulator application

>Directory (rabbitmq)

>>Dockerfile: It contains the docker configuration to build a docker image for official image of rabbitMQ since we are using it as a broker

>docker-compose: This is the docker-compose yaml configuration which helps us to build all the docker images and helps us to execute all the containers with single command


## How to execute application

In order to run the application, go to root folder of the directory. Open a terminal from there and execute following commands,

```bash
docker compose build
```

Once the images are successfully built. Then execute,

```bash
docker compose up
```

It will start the application on the terminal. It will take a little time, but you can see the results being printed on the terminal.

## View the Graph in RabbitMQ Management Server

Once the applicationsa re up and running, you can simply go to any browser in your host machine and go to http://localhost:15672/

It will ask you credentials, usually guest credentials are 'guest' as username and 'guest' as password.

While the application is being running on the terminal, you can see the graph being generated in the Overview section.

## View the written File (Output.txt)

In order to view the Output file that generated the results, you need to enter into the interactive terminal of the PVSimulator docker container. You can enter the container and view the results with following commands.

Open a new Terminal and then enter,

```bash
docker ps
```

this will list down the containers that are up and running, then you need to copy the CONTAINER ID of pvsimulator and replace it with text CONTAINERID in the following command,

```bash
docker exec -it CONTAINERID /bin/bash 
```
Once you are entered into the terminal of PV Simulator Docker container, go to the app directory where Output.txt has been generated by the applications. Once you are in the app directory, in order to view the data from Output.txt file, enter the following command,

```bash
cat Output.txt
```

## How to Stop the application

In order to stop the application, you need to terminate the application by pressing CTRL + C command. Once the application is terminated, you can execute the following command to clean up the containers created by docker-compose file,

```bash
docker compose down
```

## How to edit the code or Re build the application

If anyone wants to extend or edit the code, after all the changes please make sure to repeat those steps mentioned above from "How to execute application".
